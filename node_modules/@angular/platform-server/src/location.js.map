{"version":3,"sources":["../../../../modules/@angular/platform-server/src/location.ts"],"names":[],"mappings":"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","file":"location.js","sourceRoot":"","sourcesContent":["/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\nimport {LocationChangeEvent, LocationChangeListener, PlatformLocation} from '@angular/common';\nimport {Inject, Injectable, Optional} from '@angular/core';\nimport {DOCUMENT} from '@angular/platform-browser';\nimport {Subject} from 'rxjs/Subject';\nimport * as url from 'url';\n\nimport {scheduleMicroTask} from './facade/lang';\nimport {getDOM} from './private_import_platform-browser';\nimport {INITIAL_CONFIG, PlatformConfig} from './tokens';\n/**\n * @param {?} urlStr\n * @return {?}\n */\nfunction parseUrl(urlStr: string): {pathname: string, search: string, hash: string} {\n  const /** @type {?} */ parsedUrl = url.parse(urlStr);\n  return {\n    pathname: parsedUrl.pathname || '',\n    search: parsedUrl.search || '',\n    hash: parsedUrl.hash || '',\n  };\n}\n/**\n * Server-side implementation of URL state. Implements `pathname`, `search`, and `hash`\n * but not the state stack.\n */\nexport class ServerPlatformLocation implements PlatformLocation {\nprivate _path: string = '/';\nprivate _search: string = '';\nprivate _hash: string = '';\nprivate _hashUpdate = new Subject<LocationChangeEvent>();\n/**\n * @param {?} _doc\n * @param {?} _config\n */\nconstructor(\nprivate _doc: any,   _config: any) {\n    const config = _config as PlatformConfig | null;\n    if (!!config && !!config.url) {\n      const parsedUrl = parseUrl(config.url);\n      this._path = parsedUrl.pathname;\n      this._search = parsedUrl.search;\n      this._hash = parsedUrl.hash;\n    }\n  }\n/**\n * @return {?}\n */\ngetBaseHrefFromDOM(): string { return getDOM().getBaseHref(this._doc); }\n/**\n * @param {?} fn\n * @return {?}\n */\nonPopState(fn: LocationChangeListener): void {\n    // No-op: a state stack is not implemented, so\n    // no events will ever come.\n  }\n/**\n * @param {?} fn\n * @return {?}\n */\nonHashChange(fn: LocationChangeListener): void { this._hashUpdate.subscribe(fn); }\n/**\n * @return {?}\n */\nget pathname(): string { return this._path; }\n/**\n * @return {?}\n */\nget search(): string { return this._search; }\n/**\n * @return {?}\n */\nget hash(): string { return this._hash; }\n/**\n * @return {?}\n */\nget url(): string { return `${this.pathname}${this.search}${this.hash}`; }\n/**\n * @param {?} value\n * @param {?} oldUrl\n * @return {?}\n */\nprivate setHash(value: string, oldUrl: string) {\n    if (this._hash === value) {\n      // Don't fire events if the hash has not changed.\n      return;\n    }\n    this._hash = value;\n    const /** @type {?} */ newUrl = this.url;\n    scheduleMicroTask(\n        () => this._hashUpdate.next( /** @type {?} */(({ type: 'hashchange', oldUrl, newUrl } as LocationChangeEvent))));\n  }\n/**\n * @param {?} state\n * @param {?} title\n * @param {?} newUrl\n * @return {?}\n */\nreplaceState(state: any, title: string, newUrl: string): void {\n    const /** @type {?} */ oldUrl = this.url;\n    const /** @type {?} */ parsedUrl = parseUrl(newUrl);\n    this._path = parsedUrl.pathname;\n    this._search = parsedUrl.search;\n    this.setHash(parsedUrl.hash, oldUrl);\n  }\n/**\n * @param {?} state\n * @param {?} title\n * @param {?} newUrl\n * @return {?}\n */\npushState(state: any, title: string, newUrl: string): void {\n    this.replaceState(state, title, newUrl);\n  }\n/**\n * @return {?}\n */\nforward(): void { throw new Error('Not implemented'); }\n/**\n * @return {?}\n */\nback(): void { throw new Error('Not implemented'); }\nstatic decorators: DecoratorInvocation[] = [\n{ type: Injectable },\n];\n/** @nocollapse */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n{type: undefined, decorators: [{ type: Inject, args: [DOCUMENT, ] }, ]},\n{type: undefined, decorators: [{ type: Optional }, { type: Inject, args: [INITIAL_CONFIG, ] }, ]},\n];\n}\n\nfunction ServerPlatformLocation_tsickle_Closure_declarations() {\n/** @type {?} */\nServerPlatformLocation.decorators;\n/**\n * @nocollapse\n * @type {?}\n */\nServerPlatformLocation.ctorParameters;\n/** @type {?} */\nServerPlatformLocation.prototype._path;\n/** @type {?} */\nServerPlatformLocation.prototype._search;\n/** @type {?} */\nServerPlatformLocation.prototype._hash;\n/** @type {?} */\nServerPlatformLocation.prototype._hashUpdate;\n/** @type {?} */\nServerPlatformLocation.prototype._doc;\n}\n\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}